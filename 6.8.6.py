'''
–ö–ª–∞—Å—Å Versionedüå∂Ô∏è
–†–µ–∞–ª–∏–∑—É–π—Ç–µ –∫–ª–∞—Å—Å Versioned, –æ–ø–∏—Å—ã–≤–∞—é—â–∏–π –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—â–∏–π –¥–æ—Å—Ç—É–ø –∫–∞–∫ –∫ —Ç–µ–∫—É—â–µ–º—É –∑–Ω–∞—á–µ–Ω–∏—é –∞—Ç—Ä–∏–±—É—Ç–∞, —Ç–∞–∫ –∏ –∫–æ –≤—Å–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–º, –µ—Å–ª–∏ –∑–Ω–∞—á–µ–Ω–∏–µ –∞—Ç—Ä–∏–±—É—Ç–∞ –∫–æ–≥–¥–∞-–ª–∏–±–æ –∏–∑–º–µ–Ω—è–ª–æ—Å—å. –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞ –∫–ª–∞—Å—Å –Ω–µ –¥–æ–ª–∂–µ–Ω –ø—Ä–∏–Ω–∏–º–∞—Ç—å –Ω–∏–∫–∞–∫–∏—Ö –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤.

–î–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –¥–æ–ª–∂–µ–Ω –∑–∞–∫—Ä–µ–ø–ª—è—Ç—å—Å—è –∑–∞ –∞—Ç—Ä–∏–±—É—Ç–æ–º, –∏–º–µ—é—â–∏–º —Ç–æ –∂–µ –∏–º—è, —á—Ç–æ –∏ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è, –∫–æ—Ç–æ—Ä–æ–π –ø—Ä–∏—Å–≤–∞–∏–≤–∞–µ—Ç—Å—è –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä.

–ü—Ä–∏ –æ–±—Ä–∞—â–µ–Ω–∏–∏ –∫ –∞—Ç—Ä–∏–±—É—Ç—É –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –¥–æ–ª–∂–µ–Ω –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ —ç—Ç–æ–≥–æ –∞—Ç—Ä–∏–±—É—Ç–∞, –µ—Å–ª–∏ –æ–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ. –ï—Å–ª–∏ –∑–Ω–∞—á–µ–Ω–∏–µ –∞—Ç—Ä–∏–±—É—Ç–∞ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ, –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –≤–æ–∑–±—É–∂–¥–µ–Ω–æ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ AttributeError —Å —Ç–µ–∫—Å—Ç–æ–º:

–ê—Ç—Ä–∏–±—É—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω
–ü—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–µ –∏–ª–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∑–Ω–∞—á–µ–Ω–∏—è –∞—Ç—Ä–∏–±—É—Ç–∞ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –¥–æ–ª–∂–µ–Ω —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å –∏–ª–∏ –∏–∑–º–µ–Ω—è—Ç—å —ç—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ –±–µ–∑ –∫–∞–∫–∏—Ö-–ª–∏–±–æ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫.

–ö–ª–∞—Å—Å Versioned –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å –¥–≤–∞ –º–µ—Ç–æ–¥–∞ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞:

get_version() ‚Äî –º–µ—Ç–æ–¥, –ø—Ä–∏–Ω–∏–º–∞—é—â–∏–π –¥–≤–∞ –∞—Ä–≥—É–º–µ–Ω—Ç–∞: —ç–∫–∑–µ–º–ø–ª—è—Ä –∫–ª–∞—Å—Å–∞, –≤ –∫–æ—Ç–æ—Ä–æ–º –æ–ø—Ä–µ–¥–µ–ª–µ–Ω –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä, –∏ —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ n. –ú–µ—Ç–æ–¥ –¥–æ–ª–∂–µ–Ω –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å n-–æ–µ –ø–æ —Å—á–µ—Ç—É –∑–Ω–∞—á–µ–Ω–∏–µ –∞—Ç—Ä–∏–±—É—Ç–∞ —ç—Ç–æ–≥–æ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞ –∫–ª–∞—Å—Å–∞. –ù–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ –∑–Ω–∞—á–µ–Ω–∏–µ –∞—Ç—Ä–∏–±—É—Ç–∞ –±—ã–ª–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ, –∞ –∑–∞—Ç–µ–º –∏–∑–º–µ–Ω–µ–Ω–æ, —Ç–æ –º–µ—Ç–æ–¥ get_version() –¥–æ–ª–∂–µ–Ω —É–º–µ—Ç—å –≤–µ—Ä–Ω—É—Ç—å –∫–∞–∫ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ (–ø–µ—Ä–≤–æ–µ –ø–æ —Å—á–µ—Ç—É), —Ç–∞–∫ –∏ –∏–∑–º–µ–Ω–µ–Ω–Ω–æ–µ (–≤—Ç–æ—Ä–æ–µ –ø–æ —Å—á–µ—Ç—É)
set_version() ‚Äî –º–µ—Ç–æ–¥, –ø—Ä–∏–Ω–∏–º–∞—é—â–∏–π –¥–≤–∞ –∞—Ä–≥—É–º–µ–Ω—Ç–∞: —ç–∫–∑–µ–º–ø–ª—è—Ä –∫–ª–∞—Å—Å–∞, –≤ –∫–æ—Ç–æ—Ä–æ–º –æ–ø—Ä–µ–¥–µ–ª–µ–Ω –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä, –∏ —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ n. –ú–µ—Ç–æ–¥ –¥–æ–ª–∂–µ–Ω —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å n-–æ–µ –ø–æ —Å—á–µ—Ç—É –∑–Ω–∞—á–µ–Ω–∏–µ –∞—Ç—Ä–∏–±—É—Ç–∞ –≤ –∫–∞—á–µ—Å—Ç–≤–µ —Ç–µ–∫—É—â–µ–≥–æ
–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ 1. –í—ã–∑–æ–≤ –º–µ—Ç–æ–¥–∞ set_version() –Ω–µ –¥–æ–ª–∂–µ–Ω –ø—Ä–∏—Ä–∞–≤–Ω–∏–≤–∞—Ç—å—Å—è –∫ –∏–∑–º–µ–Ω–µ–Ω–∏—é –∑–Ω–∞—á–µ–Ω–∏—è –∞—Ç—Ä–∏–±—É—Ç–∞. –ë—É–¥–µ–º —Å—á–∏—Ç–∞—Ç—å, —á—Ç–æ –∞—Ç—Ä–∏–±—É—Ç –∏–∑–º–µ–Ω—è–µ—Ç —Å–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ –≤ —Ç–æ–º —Å–ª—É—á–∞–µ, –µ—Å–ª–∏ —ç—Ç–∞ –æ–ø–µ—Ä–∞—Ü–∏—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ —Ç–æ—á–µ—á–Ω—É—é –Ω–æ—Ç–∞—Ü–∏—é –∏–ª–∏ —Ñ—É–Ω–∫—Ü–∏—é setattr().

–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ 2. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è. –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç—Å—è, —á—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π –∫–ª–∞—Å—Å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ —Å –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏.

–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ 3. –ù–∏–∫–∞–∫–∏—Ö –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –∫–∞—Å–∞—Ç–µ–ª—å–Ω–æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∫–ª–∞—Å—Å–∞ Versioned –Ω–µ—Ç, –æ–Ω–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–π.
'''

class Versioned:
    def __set_name__(self, cls, attr):
        self._attr = attr
        
    def __get__(self, obj, cls):
        if obj is None:
            return self
        if self._attr in obj.__dict__:
            return obj.__dict__[self._attr][-1]
        else:
            raise AttributeError ('–ê—Ç—Ä–∏–±—É—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω')
           
    def __set__(self, obj, value):
        obj.__dict__.setdefault(self._attr,[]).append(value)
        
    def get_version(self,obj,n):
        if obj is None:
            return self
        if self._attr in obj.__dict__:
            return obj.__dict__[self._attr][n-1]
            
    def set_version(self,obj,n):
        tmp = obj.__dict__[self._attr][n-1]
        obj.__dict__.setdefault(self._attr,[]).append(tmp)
                        
        
        
        
'''
# INPUT DATA:

# TEST_1:
class Student:
    age = Versioned()
    
student = Student()

student.age = 18
student.age = 19

print(student.age)

# TEST_2:
class Student:
    age = Versioned()
    
student = Student()

student.age = 18
student.age = 19
student.age = 20

print(student.age)
print(Student.age.get_version(student, 1))
print(Student.age.get_version(student, 2))
print(Student.age.get_version(student, 3))

# TEST_3:
class Student:
    age = Versioned()
    
student = Student()

student.age = 18
student.age = 19
student.age = 20

print(student.age)
Student.age.set_version(student, 1)
print(student.age)

# TEST_4:
class Student:
    name = Versioned()

student = Student()

try:
    print(student.name)
except AttributeError as e:
    print(e)

# TEST_5:
class Person:
    age = Versioned()


person = Person()

person.age = 0
for _ in range(50):
    person.age += 1

for i in range(51):
    print(Person.age.get_version(person, i + 1))

# TEST_6:
class Person:
    age = Versioned()


person = Person()

person.age = 0
for _ in range(50):
    person.age += 1

print(person.age)
Person.age.set_version(person, 32)
print(person.age)

# TEST_7:
class Student:
    age = Versioned()


student1 = Student()
student2 = Student()

student1.age = 18
student1.age = 19
student1.age = 20

student2.age = 30
student2.age = 31
student2.age = 32

print(student1.age)
print(student2.age)
Student.age.set_version(student1, 1)
Student.age.set_version(student2, 2)
print(student1.age)
print(student2.age)
'''
# TEST_8:
class Student:
    age = Versioned()


student = Student()

student.age = 18
student.age = 19
student.age = 20

print(student.age)# ok

Student.age.set_version(student, 1)

print(student.age) # ok

for i in range(3):
    print(Student.age.get_version(student, i + 1))

Student.age.set_version(student, 2)

print(student.age)
for i in range(3):
    print(Student.age.get_version(student, i + 1))
'''
# TEST_9:
class Student:
    age = Versioned()

print(Student.age.__class__) '''
           